% ============================================================
% 2025 SystemDK with AITL Core 日本語版 (純粋工学理論稿) - Modular
% ============================================================

\documentclass[conference]{IEEEtran}

% ----------------------
% Core packages (order)
% ----------------------
\usepackage[T1]{fontenc}        % 欧文エンコーディング
\usepackage{CJKutf8}            % 日本語（CJK）

\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{bm}
\usepackage{cite}

\usepackage{xcolor}             % ← color より xcolor 推奨（listings背景用）
\usepackage{listings}           % ソースコードは英数のみ
\usepackage{booktabs}
\usepackage{textcomp}
\usepackage{array}
\usepackage{tabularx}           % ← 表の可変幅
\newcolumntype{Y}{>{\raggedright\arraybackslash}X}
\newcolumntype{Z}{>{\centering\arraybackslash}X}

\usepackage{siunitx}
\sisetup{                        % ← detect-* の非推奨を回避
  mode = match,
  propagate-math-font = true,
  reset-math-version = false,
  reset-text-family  = false,
  reset-text-series  = false,
  reset-text-shape   = false,
  text-family-to-math = true,
  text-series-to-math = true,
  table-format = 3.2
}

\usepackage{microtype}          % はみ出し/アンダーフル緩和

% --- TikZ（図用） ---
\usepackage{tikz}
\usetikzlibrary{arrows.meta,positioning,shapes,fit,calc}

% --- algorithms（使う場合のみ） ---
\usepackage{algorithm}
\usepackage{algorithmic}

% ----------------------
% hyperref は最後に近い位置で
% ----------------------
\usepackage[hidelinks]{hyperref}

% ----------------------
% はみ出し対策（実用設定）
% ----------------------
\emergencystretch=3em          % 行末の融通を増やす
\frenchspacing                 % 句点後の余白を詰める（欧文）
\def\UrlBreaks{\do\/\do-\do_\do.\do:\do?\do&}

% --- listings: 日本語は入れない（CJK外） ---
\definecolor{lightgray}{gray}{0.95}
\lstset{
  backgroundcolor=\color{lightgray},
  basicstyle=\ttfamily\footnotesize,
  frame=single,
  breaklines=true,
  breakatwhitespace=false,
  tabsize=2,
  keepspaces=true,
  columns=fullflexible,
  extendedchars=false,   % 日本語を listings に入れない
  inputencoding=ascii,
  postbreak=\mbox{$\hookrightarrow$\space}
}

% --- listings: JSON 言語定義（Appendix B 用） ---
\lstdefinelanguage{json}{
  basicstyle=\ttfamily\footnotesize,
  numbers=left, numberstyle=\tiny, stepnumber=1, numbersep=6pt,
  showstringspaces=false,
  breaklines=true, breakatwhitespace=false,
  frame=single,
  morestring=[b]",
  stringstyle=\color{black},
  literate=
   *{0}{{0}}1 {1}{{1}}1 {2}{{2}}1 {3}{{3}}1 {4}{{4}}1
    {5}{{5}}1 {6}{{6}}1 {7}{{7}}1 {8}{{8}}1 {9}{{9}}1
    {:}{{:}}1 {,}{{,}}1 {\{}{{\{}}1 {\}}{{\}}}1 {[}{{[}}1 {]}{{]}}1
}

% ----------------------
% タイトル・著者
% ----------------------
\title{SystemDK with AITL Core：設計・信頼性・制御を統合する自律的アーキテクチャ}

\author{%
  \IEEEauthorblockN{三溝 真一 (Shinichi Samizo)}%
  \IEEEauthorblockA{独立系半導体研究者（元セイコーエプソン） / Independent Semiconductor Researcher (ex-Seiko Epson)\\%
  Email: \href{mailto:shin3t72@gmail.com}{shin3t72@gmail.com}\quad
  GitHub: \url{https://github.com/Samizo-AITL}}%
}

\begin{document}

% ===== CJK開始：IPAex 明朝(ipxm) =====
%   ※ 日本語は CJK 環境内、欧文は通常のままでOK
\begin{CJK}{UTF8}{ipxm}

\maketitle

% --- abstract & keywords ---
\input{chap0_abstract}

% --- chapters ---
\input{chap1_intro}
\input{chap2_systemdk}
\input{chap3_aitl}
\input{chap4_flow}        % ← 日本語や矢印は listings に入れないこと
\input{chap5_reliability}
\input{chap6_discussion}
\input{chap7_conclusion}

% --- appendix ---
\input{appendix}

% --- references（使うときだけ有効化） ---
% \bibliographystyle{IEEEtran}
% \bibliography{references}

% --- biography ---
\input{biography}

\end{CJK}
\end{document}
